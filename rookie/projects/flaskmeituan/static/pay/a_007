;M.add("dealbuy-quantity",function(t){var e=t.mt.macro.key;t.mt.ComponentHub.attach("dealbuy-quantity",function(n){function a(t){if(r(t))return o.$set("quantity",t),o.onchange(t),void p.dispatch({actionType:I.HIDE_MSG,id:y});p.dispatch({actionType:I.SHOW_MSG,id:y,type:"error",msg:f})}function r(t){var e=t;return f="",e!==e?(f="请输入正确的购买数量",!1):d>0&&e>d?(f="每个订单最多能购买 "+d+" 件",!1):c&&e>c?(f="抱歉，数量有限，您最多只能购买 "+c+" 件",!1):m&&e>m?(f="本单只剩 "+m+" 件了",!1):e<s?(f="您最少需要购买 "+s+" 件",!1):!(e>w)||(f="每个订单最多能购买 "+w+" 件",!1)}function u(t){var e=t?t.get("value"):o.quantity;return parseInt(e,10)}var i=n.component.params||{},o=this.getScope(),c=i.remain,m=i.totalRemain,s=i.minNumPerOrder,d=i.maxNumPerOrder,f="",y="quantity_error",p=t.mt.flux,I=t.mt.require("www-constants-common"),w=Math.min(m>0?m:Number.POSITIVE_INFINITY,c,d>0?d:Number.POSITIVE_INFINITY);o.$default({onchange:function(){},increase:function(){a(u()+1)},decrease:function(){a(u()-1)},keyup:function(t){var n=t.target;switch(t.keyCode){case e.UP:a(u(n)+1);break;case e.DOWN:a(u(n)-1);break;default:a(u(n))}}})})},"1.0.0",{requires:["www-base","mt-scope","www-constants-common","mt-flux"]});
;M.add("dealbuy-card",function(e){e.mt.ComponentHub.attach("dealbuy-card",function(){var t=this.getScope(),a=e.mt.macro.key,d=e.mt.flux,n=e.mt.require("www-constants-buy");return t.$default({cards:[],selectedCard:null,isLogin:!1,onSelectCard:function(){},usePlain:!1,useInteractive:!1,inputCardCode:null,isShowCardList:!1,cardValue:0,toggleSelect:function(e){t.$set("isShowCardList",e),t.onSelectCard(null)},isCardDisabled:function(e){var t=(this.cards||[]).filter(function(t){return String(e)===String(t.code)})[0];return t&&t.disabled},selectCard:function(e){t.isCardDisabled(e)||t.onSelectCard(e)},keypress:function(e){e.keyCode===a.ENTER&&(e.halt(),t.verifyInputCardCode())},setInputCardCode:function(e){t.inputCardCode=e},verifyInputCardCode:function(){var e=t.inputCardCode;if(/^\s+$/.test(e)||!e)return void d.dispatch({actionType:n.CARD_ERROR_MSG,msg:"抵用券密码不能为空并且不能包含空格"});t.onSelectCard(e)}}),t.$watch("selectedCard",function(e){t.$set("cardValue",!t.isCardDisabled(e.code)&&e.value||0)}),t.isLogin?t.selectedCard&&t.selectedCard.code>0?void(t.usePlain=!0):void(t.useInteractive=!0):void(t.usePlain=!0)})},"1.0.0",{requires:["www-base","mt-scope","mt-flux","www-constants-buy"]});
;M.add("dealbuy-mobile",function(o){function e(o){o.one("#deal-buy-rebind").on("click",function(){i.Cookie.set("fromurl",window.location.href,i.Cookie.getExpiresDate(0,0,60),"/","."+M.DOMAIN_HOST)})}var i=o.mt.util;o.mt.ComponentHub.attach("dealbuy-mobile",function(){this.one("#J-common-normal-mobile")&&e(this)})},"1.0.0",{requires:["mt-base"]});
