;YUI.add("yui-throttle",function(t,n){t.throttle=function(n,i){if(-1===(i=i||(t.config.throttleTime||150)))return function(){n.apply(this,arguments)};var r=t.Lang.now();return function(){var o=t.Lang.now();o-r>i&&(r=o,n.apply(this,arguments))}}},"3.16.0",{requires:["yui-base"]});
;M.add("w-slider",function(e){var t=e.Lang.isFunction,i=e.UA,n=e.mt.util,r={triggerContainer:"mt-slider-trigger-container",triggerContainerEx:"mt-slider-trigger-container-ex",trigger:"mt-slider-trigger",currentTrigger:"mt-slider-current-trigger",sheetContainer:"mt-slider-sheet-container",sheet:"mt-slider-sheet",currentSheet:"mt-slider-current-sheet",previous:"mt-slider-previous",next:"mt-slider-next"},s=e.config["w-slider"]||{},a=function(){a.superclass.constructor.apply(this,arguments)};a.NAME="Slider",a.CSS_PREFIX="mt-slider",a.HTML_PARSER={sheetContainer:"> ."+r.sheetContainer,triggerContainer:"> ."+r.triggerContainer,triggerContainerEx:"> ."+r.triggerContainerEx,previous:"> .previous",next:"> .next"},a.TEMPLATE={trigger:'<a href="javascript:;" hidefocus="true" class="{previous}"></a><a href="javascript:;" hidefocus="true" class="{next}"></a>',statusBar:"<ul></ul>"},a.CLASS_NAME=r,a.ATTRS={sheetContainer:{value:null,setter:function(t){return e.one(t)}},triggerContainerEx:{value:null,setter:function(t){return e.one(t)}},triggerContainer:{value:null,setter:function(t){return e.one(t)}},pnContainer:{value:null,setter:function(t){return e.one(t)}},previous:{value:null,setter:function(t){return e.one(t)}},next:{value:null,setter:function(t){return e.one(t)}},autoPlay:{value:!0},activeStop:{value:!0},pnAutoHide:{value:!1},interval:{value:5e3},effect:{value:"slideLeft"},duration:{value:300},triggerEvent:{value:"click"},index:{value:0},hoverOpacity:{value:i.ie<=8&&i.ie>0?1:.6},lazyloading:{value:!1}},e.extend(a,e.Widget,{initializer:function(){var e=this,t=e.get("sheetContainer"),i=t&&t.all("> li");if(i&&i.isEmpty())throw new Error(a.NAME+": 没有内容页");e._timer=null,e._handles={},e._pause=!1,e._nlSheet=i},destructor:function(){n.detachHandle(this._handles),this.get("boundingBox").remove(!0)},_beforeRenderUI:function(){var e=this.get("index"),t=this._nlSheet,i=t.item(e);this._updateImgs(i),i.show(),"slideFadeIn"===this.get("effect")&&(t.setStyle("opacity",0),i.setStyle("opacity",1))},_afterRenderUI:function(){var e=this._nlSheet,t=(this.get("index")+1)%e.size();this._updateImgs(e.item(t))},_updateImgs:function(e){this.get("lazyloading")&&e.all("img[data-src]").each(function(e){s.cssLazyClass&&e.on("load",function(){e.removeClass(s.cssLazyClass)}),e.set("src",e.getAttribute("data-src")),e.removeAttribute("data-src")})},renderUI:function(){this._beforeRenderUI(),this._renderTriggerContainer(),this._modifySheetContainer(),this._renderPreNextContainer(),this._anim=this._getAnim(),this._afterRenderUI()},_renderTriggerContainer:function(){var e=this.get("triggerContainer"),t=this.get("triggerContainerEx"),i=this._nlSheet,n=this.get("index"),s=0,a=null;e?(s=e.all("> li").size(),i.size()!==s&&e.setHTML(function(){for(var e=[],t=0;t<i.size();t++)e.push("<li></li>");return e.join("")}()),"none"===e.getStyle("display")&&e.show(),a=e.all("> li"),a.addClass(r.trigger),a.item(n).addClass(r.currentTrigger),e.addClass(r.triggerContainer)):t&&(t.one(".total").setHTML(i.size()),t.one(".current").setHTML(1),"none"===t.getStyle("display")&&t.show())},_modifySheetContainer:function(){var e=this.get("sheetContainer"),t=this._nlSheet,i=this.get("index");e.addClass(r.sheetContainer),t.addClass(r.sheet),t.item(i).addClass(r.currentSheet),t.each(function(e,t){t!==i&&e.hide()})},_renderPreNextContainer:function(){var e=this.get("previous"),t=this.get("pnAutoHide"),i=this.get("next");i||e?t&&(e&&(e.setStyle("opacity",0),e.show()),i&&(i.setStyle("opacity",0),i.show())):this.buildPreNext()},buildPreNext:function(){var t,i,n,s=this.get("pnContainer"),o=this.get("pnAutoHide");s&&(n=e.Node.create(e.Lang.sub(a.TEMPLATE.trigger,r)),s.append(n),this.set("previous",t=s.one("."+r.previous)),this.set("next",i=s.one("."+r.next)),o&&(t.setStyle("opacity",0),i.setStyle("opacity",0)))},bindUI:function(){var e=this,t=e.get("triggerContainer"),i=e.get("sheetContainer"),n=this.get("pnAutoHide"),r=t&&t.all("> li");e.isFromNavigator=!1,e.after("indexChange",this._defIndexChangeFn,this),i.on({mouseover:function(){e.pause()},mouseout:function(){e.reset()}}),r&&r.each(function(t,i){t.on(e.get("triggerEvent"),function(t){t.halt(),e.set("index",i),e._activeStop=!0,e.reset()})}),this.lrBtnClickHandler(),n&&this.handleLrBtnHide()},syncUI:function(){this.get("autoPlay")&&this.play()},lrBtnClickHandler:function(){var e=this.get("previous"),t=this.get("next"),i=this;e&&e.on("click",function(e){e.halt(),i.showPrevious(),i._activeStop=!0,i.reset()}),t&&t.on("click",function(e){e.halt(),i.showNext(),i._activeStop=!0,i.reset()})},handleLrBtnHide:function(){function e(){s.setStyle("opacity",l),a.setStyle("opacity",l)}function t(e){e.pageX>n.left&&e.pageX<n.left+n.width&&e.pageY>n.top&&e.pageY<n.top+n.height||(s.setStyle("opacity",0),a.setStyle("opacity",0))}var i,n,r,s=this.get("previous"),a=this.get("next"),o=this,l=this.get("hoverOpacity");a&&s&&(r={mouseover:e,mouseout:t},i=o.get("sheetContainer"),n=i.get("region"),i.delegate(r,".mt-slider-sheet"),a.on(r),s.on(r))},_defIndexChangeFn:function(e){var t=this,i=t.get("triggerContainer"),n=t.get("triggerContainerEx"),s=i&&i.all("> li"),a=t._nlSheet,o=a.size(),l=e.prevVal,u=e.newVal;s&&e.newVal>=s.size()||(t._updateImgs(a.item(e.newVal)),s&&(s.item(l).removeClass(r.currentTrigger),s.item(u).addClass(r.currentTrigger)),n&&n.one(".current").setHTML(u+1),t.isFromNavigator||(2===o?t._dir=!0:Math.abs(u-l)===o-1?t._dir=u<l:t._dir=u>l),t._anim(a.item(l),a.item(u)))},_getAnim:function(){var i,n,r,s,o,l,u=this,g=u.get("sheetContainer"),d=u.get("effect"),h=u.get("duration")/1e3,c=null,f=null,p=null,v=!0;switch(d){case"slideHorizontal":case"slideLeft":i=parseInt(g.getStyle("width"),10),n={left:i},o={left:-i},l={left:0},f={nextStyles:{left:i},currentAnimTo:{left:-i}},p={nextStyles:{left:-i},currentAnimTo:{left:i}};break;case"slideVertical":case"slideUp":i=parseInt(g.getStyle("height"),10),n={top:i},o={top:-i},l={top:0},f={nextStyles:{top:i},currentAnimTo:{top:-i}},p={nextStyles:{top:-i},currentAnimTo:{top:i}};break;case"slideFadeIn":o={opacity:0},l={opacity:1};break;default:throw new Error(a.NAME+": 切换效果类型不存在")}return r=new e.Anim({from:{},to:o||{},duration:h,easing:e.Easing.easeBoth}),s=new e.Anim({from:{},to:l||{},duration:h,easing:e.Easing.easeBoth}),c=p||null,function(e,i,a){c&&u._dir!==v&&(v=u._dir,n=c.nextStyles,r.set("to",c.currentAnimTo),c=c===f?p:f),u.isFromNavigator=!1,r.stop(!0),s.stop(!0),n&&i.setStyles(n),i.show(),r.set("node",e),r.detach("end"),r.on("end",function(){e.hide()}),s.set("node",i),s.detach("end"),s.on("end",function(){t(a)&&a(),u.fire("endAnim",{index:u.get("index")})}),r.run(),s.run()}},showPrevious:function(){var e=this,t=e.get("index"),i=e._nlSheet.size(),n=0===t?i-1:(t-1)%i;e.isFromNavigator=!0,e._dir=!1,e.set("index",n)},showNext:function(){var e=this,t=e.get("index"),i=e._nlSheet.size(),n=(t+2)%i,r=(t+1)%i;e.isFromNavigator=!0,e._dir=!0,e.set("index",r),e._updateImgs(this._nlSheet.item(n))},pause:function(){this._pause=!0},reset:function(){var e=this;if(e._pause=!1,e.get("autoPlay")){if(window.clearTimeout(e._timer),e.get("activeStop")&&e._activeStop)return;e.play()}},isPause:function(){return this._pause},play:function(){var e=this;e._timer=window.setTimeout(function(){e.isPause()||(e.showNext(),e.play())},e.get("interval"))}}),e.mt.widget.Slider=a},"1.0.0",{requires:["mt-base","anim","widget","node"],skinnable:!0});
;M.add("w-carousel-base",function(t){var e="widget-carousel",i={navlink:e+"-navlink",prev:e+"-navlink-prev",next:e+"-navlink-next",content:e+"-content",list:e+"-list",listitem:e+"-list-item"},n={ndList:"ul",nlItems:["ul li"],previous:"."+i.prev,next:"."+i.next},s={navs:'<a href="#" hidefocus="true" class="widget-carousel-navlink widget-carousel-navlink-prev"></a><a href="#" hidefocus="true" class="widget-carousel-navlink widget-carousel-navlink-next"></a>'},a={ndList:{value:null,setter:function(e){return t.one(e)}},nlItems:{value:null,setter:function(e){return e&&e.size?e:t.all(e)}},itemDimension:{value:0},itemGapDimension:{value:0},winDimension:{value:0},orientation:{value:"horizontal"},fulfill:{value:!0},page:{value:0,setter:function(t){var e=this._metrics.pageCount;return(t+e)%e}},previous:{value:null,setter:function(e){return t.one(e)}},next:{value:null,setter:function(e){return t.one(e)}},itemClickable:{value:!0},slideSpeed:{value:.4}},o=t.Base.create("carouselbase",t.Widget,[],{initializer:function(){var t,e,i=this.get("ndList"),n=this.get("nlItems"),s=this.get("contentBox");if(!i)throw new Error("Y.mt.widget.CarouselBase: 列表节点不存在");"vertical"===this.get("orientation")?this._orientationData={name:"height",slideStart:"top",direction:"Bottom",winDimensionProperty:"offsetHeight"}:this._orientationData={name:"width",slideStart:"left",direction:"Right",winDimensionProperty:"offsetWidth"},this.get("winDimension")||this.set("winDimension",s.get(this._orientationData.winDimensionProperty)),n.size()&&(this.get("itemDimension")||(t=n.item(0).get(this._orientationData.winDimensionProperty),this.set("itemDimension",t)),this.get("itemGapDimension")||(e=n.item(0).getStyle("margin"+this._orientationData.direction),this.set("itemGapDimension",parseInt(e,10)||0))),this._calculateMetrics()},renderUI:function(){this._renderItems(),this._renderItemsNav()},bindUI:function(){var e=this.get("contentBox");this.after("pageChange",this._afterPageChange),e.delegate("click",t.bind(this._onItemClick,this),"."+o.CSS_NAME.listitem),this._hasNavlink&&e.delegate("click",t.bind(this._onNavLinkClick,this),"."+o.CSS_NAME.navlink)},syncUI:function(){this.get("nlItems").size()&&this._syncPageView()},_calculateMetrics:function(){var t=this.get("itemDimension"),e=this.get("itemGapDimension"),i=this.get("winDimension"),n=(this.get("ndList"),this.get("nlItems")),s=(this.get("orientation"),t+e);if(0===s)throw new Error("Y.mt.widget.CarouselBase: 展示项的宽度为 0");var a=n&&n.size()||0,o=i+e,r=Math.floor(o/s),l=r*s,h=Math.ceil(a/r),g=s*a;this.get("fulfill")||(g=(h-1)*l+o),this._metrics={itemBoxDimension:s,itemCount:a,fixedWinDimension:o,singlePageItemCount:r,singlePageDimension:l,pageCount:h,totalDimension:g,shift:0},this._dir="next",this._hasNavlink=!1,h>1&&(this._hasNavlink=!0)},_renderItems:function(){var t=this.get("ndList"),e=this.get("nlItems"),i=this.get("contentBox");e.size()&&(i.addClass(o.CSS_NAME.content+"--"+this.get("orientation")),t.addClass(o.CSS_NAME.list),e.addClass(o.CSS_NAME.listitem),e.each(function(t,e){t.setData("index",e)}),t.setStyle(this._orientationData.name,this._metrics.totalDimension),t.setStyle(this._orientationData.slideStart,0))},_renderItemsNav:function(){var e,i,n=this.get("previous"),s=this.get("next"),a=this.get("contentBox");n&&s?this._hasNavlink?(n.addClass(o.CSS_NAME.navlink),n.addClass(o.CSS_NAME.prev),s.addClass(o.CSS_NAME.navlink),s.addClass(o.CSS_NAME.next)):(n.hide(),s.hide()):this._hasNavlink&&(e=o.TEMPLATE.navs,i=t.Node.create(e),n=i.one("."+o.CSS_NAME.prev),s=i.one("."+o.CSS_NAME.next),this.set("previous",n),this.set("next",s)),a.append(n),a.append(s)},nextPage:function(){this.set("page",this.get("page")+1)},prevPage:function(){this.set("page",this.get("page")-1)},_afterPageChange:function(t){var e=this._metrics,i=e.shift,n=e.totalDimension,s=e.singlePageDimension,a=(t.newVal-t.prevVal)*s,o=e.fixedWinDimension,r=i+a;r<0?(this._dir="next",r=0):r+o>n&&(this._dir="prev",r=n-o),e.shift=r,this._syncPageView()},_onItemClick:function(t){var e=t.currentTarget,i=+e.getData("index");this.get("itemClickable")&&this.set("page",this._getPageByIndex(i)),this.fire("itemClick",e,i)},_onNavLinkClick:function(t){t.preventDefault(),t.target.hasClass(o.CSS_NAME.prev)?this.prevPage():this.nextPage()},_getPageByIndex:function(t){var e=this._metrics,i=(e.totalDimension,e.itemCount),n=e.pageCount,s=e.singlePageItemCount;e.shift;return"next"!==this._dir&&this.get("fulfill")?n-Math.ceil((i-t)/s):Math.ceil((t+1)/s)-1},_syncPageView:function(){var e=this.get("page"),i=this._metrics.pageCount,n={node:this.get("ndList"),to:{},duration:this.get("slideSpeed"),easing:"easeIn"};n.to[this._orientationData.slideStart]=-this._metrics.shift,new t.Anim(n).run(),this._hasNavlink&&(this.get("previous").show(),this.get("next").show(),0===e?this.get("previous").hide():e===i-1&&this.get("next").hide())}},{NAME:"CarouselBase",ATTRS:a,CSS_PREFIX:e,CSS_NAME:i,HTML_PARSER:n,TEMPLATE:s});t.namespace("mt.widget"),t.mt.widget.CarouselBase=o},"1.0.0",{requires:["mt-base","base-build","widget","anim"],skinnable:!0});
;M.add("www-dishlist",function(t){function e(e){this._options=t.merge({show:!1},e||{}),this._ndContainer=t.one("#meishi-menu"),this._ndContainer&&(this._ndPrompt=this._ndContainer.one(".prompt"),this.initMenu(),this.initCarousel(),this.initSliderList())}var i=t.mt.widget.Slider,n=t.mt.widget.CarouselBase;e.prototype.initMenu=function(){var t=this._ndContainer.one(".more");t&&t.on("click",this.toggleMenu)},e.prototype.initCarousel=function(){var t=this._ndContainer.one(".thumbnails");if(t){new n({srcNode:t,itemSize:130,itemGapSize:6,winSize:680,fulfill:!1}).render()}},e.prototype.initSliderList=function(){var e=this,i=e._options.show,n=e._ndContainer.all(".thumbnails li"),o=e._ndContainer.all(".preview");n.isEmpty()||t.each(n,function(t,r){var s=o.item(r);e.initSlider(s),i&&0===r&&(s.removeClass("hidden"),e.lazyload(s)),t.on("click",function(){n.each(function(e){e===t?e.toggleClass("current"):e.removeClass("current")}),e.lazyload(s),o.each(function(t){t===s?t.toggleClass("hidden"):t.addClass("hidden")})})},e)},e.prototype.initSlider=function(t){var e,n=this,o=t.one(".cover"),r=t.one(".previous"),s=t.one(".next"),a=t.one("ul"),l=new i({sheetContainer:a,autoPlay:!1,effect:"slideFadeIn",duration:10});r.on("click",function(){var t=o.get("text"),i=l.get("index")+1;1===i?n.prompt("已经是第一张图片"):(l.showPrevious(),e=a.all("> li img").item(l.get("index")).getStyle("height"),a.setStyle("height",e),o.set("text",t.replace(i,l.get("index")+1)))}),s.on("click",function(){var i=o.get("text"),r=l.get("index")+1;r===t.all("li").size()?n.prompt("已经是最后一张图片"):(l.showNext(),e=a.all("> li img").item(l.get("index")).getStyle("height"),a.setStyle("height",e),o.set("text",i.replace(r,l.get("index")+1)))}),l.render()},e.prototype.toggleMenu=function(){var e=t.all("#meishi-menu table");t.each(e,function(t){t.toggleClass("hidden")})},e.prototype.prompt=t.throttle(function(t){var e=this;e._ndPrompt.set("text",t),e._ndPrompt.show(),setTimeout(function(){e._ndPrompt.hide()},1e3)},1e3);e.prototype.lazyload=function(t){t.all("img[data-src]").each(function(t){var e=t.getAttribute("data-src");e&&(t.set("src",e),t.removeAttribute("data-src"))})},t.namespace("mt.www.Dishlist"),t.mt.www.Dishlist=e},"1.0.0",{requires:["node","yui-throttle","www-base","w-slider","w-carousel-base"]});
